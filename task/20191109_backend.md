2019å¹´Webç»„åç«¯æ–°äººä»»åŠ¡ç¬¬ä¸‰æœŸ

## å‰è¨€

> ä¼—æ‰€å‘¨çŸ¥åç«¯å·¥ç¨‹å¸ˆåˆç§°ä¸ºCURDå·¥ç¨‹å¸ˆï¼Œæ‰€ä»¥è¿™æœŸä»»åŠ¡æˆ‘ä»¬å°±æ¥äº†è§£ä¸‹CURDã€‚ç”±äºå‡ºé¢˜äººSQLè¯­å¥æå…¶ä¸ç†Ÿç»ƒï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢æ£€æŸ¥æ–°äººä»»åŠ¡æ—¶å‡ºç°å°´å°¬ç”»é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±**ä¸ç›´æ¥**ç”¨SQLæ¥åšCURDäº†ï¼ˆğŸ˜ğŸ˜ï¼‰ã€‚ä¸åºŸè¯äº†ï¼Œå¼•å‡ºè¿™å‘¨çš„ä¸»é¢˜---- ORMã€‚

## ä»€ä¹ˆæ˜¯ORM

* æˆ‘ä¹Ÿè¯´ä¸æ¸…ï¼ˆğŸ˜ğŸ˜ï¼‰ï¼Œä¸å¦‚è´´å¤§ä½¬çš„é“¾æ¥å§ï½ï½ ï¼š[é˜®ä¸€å³°](http://www.ruanyifeng.com/blog/2019/02/orm-tutorial.html)

## ä»»åŠ¡è¦æ±‚

* **è‡ªå·±å®ç°**  ä¸€ä¸ªçš„ORMæ¡†æ¶

* å…·ä½“è¦æ±‚

  * Create

    * å½“è‡ªå®šä¹‰çš„Objectåœ¨æ•°æ®åº“ä¸å­˜åœ¨å¯¹åº”çš„è¡¨æ—¶ï¼Œæ”¯æŒåœ¨æ•°æ®åº“ä¸­åˆ›å»ºè¡¨ã€‚Object ä¸æ•°æ®åº“è¡¨çš„å­—æ®µå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼ˆç”¨ä¸‹åˆ’çº¿åˆ†å‰²å•è¯ï¼‰:

      ![æˆªå±2019-11-0921.12.58](/Users/mac/Documents/uniqueweb/task/æˆªå±2019-11-0921.12.58.png)

    * æ”¯æŒObjectå®ä¾‹çš„åˆ›å»º

    * è¡¨çš„åˆ›å»ºæ”¯æŒ**ç´¢å¼•**ï¼Œ**ä¸»é”®**

  * Update

    * å¯¹å­˜åœ¨æ•°æ®è¿›è¡Œæ•´ä½“æ›´æ–°ï¼Œä¸å­˜åœ¨æ•°æ®åšä¸€ä¸ªé”™è¯¯å¤„ç†

  * Retrieve

    * é»˜è®¤é€šè¿‡Objectçš„ä¸»é”®å­æ®µæŸ¥æ‰¾
    * æŒ‡å®šå­—æ®µæŸ¥è¯¢ï¼Œå°†æ•°æ®æ˜ å°„åˆ°Objectï¼Œæ”¯æŒæ‰¹é‡æŸ¥è¯¢ï¼ˆè¿”å›ç»“æœåº”è¯¥ä¸º å¯¹è±¡æ•°ç»„ï¼‰

  * Delete

    * é»˜è®¤é€šè¿‡Objectçš„ä¸»é”®å­—æ®µæŸ¥æ‰¾åˆ é™¤
    * æ”¯æŒæ‰¹é‡åˆ é™¤

## è¿›ä¸€æ­¥çš„è§£é‡Šè¯´æ˜

* ç”±äºå‰é¢çš„è¦æ±‚å¯èƒ½ä¼šé€ æˆæ­§ä¹‰ï¼Œè¿™é‡Œç”¨ä»£ç çš„å½¢å¼æ¥æè¿°ä¸€ä¸‹ï¼Œåœ¨è¿™ä¹‹å‰è¯´ä¸€ä¸‹å®ç°ORMçš„æ€è·¯
  * ç”¨åå°„å®ç°ORMï¼ŒJavaçš„ORMæ¡†æ¶Mybatisï¼ŒHibernateï¼ŒGoä¸­Gormï¼Œå³é€šè¿‡åå°„è·å–Objectçš„å¯¹è±¡ä¿¡æ¯ï¼Œç„¶åè½¬åŒ–æˆSQLè¯­å¥

* å®ä¾‹

  * ```go
    package model
    
    //MyObject æ˜¯è‡ªå®šä¹‰çš„Object,`json:"id" myorm:"column: id;"` æ˜¯å¯¹äºè¯¥å­—æ®µçš„ä¸€äº›tag
    //å¯ä»¥æŠŠObjectåœ¨æ•°æ®åº“è¡¨ä¸­å¯¹åº”çš„ä¿¡æ¯æ”¾åœ¨é‡Œé¢ï¼Œç±»ä¼¼äºJavaçš„Annotation
    //Pythonçš„è£…é¥°å™¨Decorator(pythonä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¦‚æœè¯´å‡ºäº†è¯·æŒ‡æ­£)
    //ä¿¡æ¯è¡¨ç¤ºæ ¼å¼å¯ä»¥è‡ªè¡Œå®šä¹‰
    //æ”¯æŒå®šä¹‰çš„å­—æ®µå±æ€§: ä¸»é”®(å¿…é¡»æŒ‡å®š)ã€ç´¢å¼•ã€æ•°æ®ç±»å‹ã€æ˜¯å¦éç©º(æ”¯æŒè®¾å®šé»˜è®¤å€¼)ã€æ˜¯å¦ä¸å¯é‡å¤ã€
    //æœªæ˜¾ç¤ºæŒ‡å®šç±»å‹æ—¶ é»˜è®¤è½¬åŒ–ä¸º: string -> varchar int-> int ,int64->bigint
    type MyObject struct {
    	ID         int    `myorm:"column:id;primary_id"`
    	Price      int    `myorm:"column:int`
    	ObjectName string `myorm:"column:object_name;type:varchar(50);index"`
    	Info       string `myorm:"column:info";type:text;`
    }
    
    /*
    å®šä¹‰äº†ä»¥ä¸ŠObjectåï¼Œæˆ‘ä»¬å¸Œæœ›ä½ å®ç°ä»¥ä¸‹åŠŸèƒ½
    æ¨¡å¼ä¸€ï¼Œå®ç°äº†ä¸€ä¸ªDBç±»ï¼Œè¿™ä¸ªç±»å…·æœ‰ä»¥ä¸‹èƒ½åŠ›
    */
    myObject := &MyObject{ID: 1, ObjectName: "object_name", Info: "info"}
    
    
    //1.é€šè¿‡ä¼ å…¥ä¸€ä¸ªObjectå®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ï¼Œå¦‚æœè¡¨å­˜åœ¨ åˆ™ä¸åˆ›å»ºï¼Œä½†æ˜¯éœ€è¦è®©è°ƒç”¨è€…çŸ¥é“(æŠ›å‡ºé”™è¯¯æˆ–è€…è¿”å›å€¼)
    DB.CreateTable(myObject)
    //2.è¡¨ä¸­åˆ›å»ºä¸€ä¸ªå®ä¾‹è®°å½•
    DB.Create(myObject)
    //3.æ›´æ–°è¡¨æ•°æ®
    DB.Update(myObject)
    //4.æŸ¥è¯¢è¡¨æ•°æ® Find çš„å‡½æ•°å£°æ˜åº”è¯¥å’Œè¿™ä¸ªç±»ä¼¼ï¼š
    // func Find(whereExpression string,queryParams ...interface{},dumpInstance interface{})(bool,error);
    DB.FindOne("id = ?",myObject.ID,&myObject);
    // æˆ–è€… func Find(whereExpression string,queryParams ...interface{})(interface{},error);
    //5.æ‰¹é‡æŸ¥è¯¢
    // func FindAll(whereExpression string,queryParams []interface{},dumpInstance interface{}) error;
    // func FindAll(whereExpression string,queryParams ...interface{})([]interface{},error);
    res := make([]*MyObject, 0)
    DB.FindAll("price = ?",15,res)
    //6.Delete 
    // func Delete(objToDel interface{}) error;
    DB.Delete(myObject)
    //7.DeleteAll
    // func DeleteAll(whereExpression string,queryParams ...interface{})error;
    Db.DeleteAll("id in ()",[]int64{1,2,3});
    // è¿›é˜¶
    // çœ‹ä¸€ä¸‹5 6çš„æŸ¥è¯¢ï¼Œå…¶å®åˆ†æä¸€ä¸‹æˆ‘ä»¬å¯ä»¥æŠŠæ¥å£è®¾è®¡çš„æ›´åŠ ä¼˜é›…
    // func FindAll(whereExpression string,queryParams []interface{},dumpInstance interface{}) error; è¿™æ ·çš„æ¥å£å®åœ¨å¤ªä¸‘äº†
    //æˆ‘ä»¬å¯ä»¥æ”¹é€ ä¸€ä¸‹æŠŠå®ƒåšæˆé“¾å¼è°ƒç”¨ å¦‚
    // func where(whereExpression string,queryParams ...interface{}) DB;
    // func FindOne(dumpInstance interface{}) error ;
    DB.where().FindOne()
    // FindAll åŒç†
    Db.where().FindAll()
    ```



## è¦æ±‚

* è¯­è¨€ä¸é™
* ä¸€æ˜ŸæœŸ
* ä¸è®¸ç›´æ¥ç²˜è´´ç½‘ä¸Šçš„ä»£ç 